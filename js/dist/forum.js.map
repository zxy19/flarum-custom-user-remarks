{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@xypp/flarum-custom-user-remarks/./src/forum/EditRemarkModal.tsx","webpack://@xypp/flarum-custom-user-remarks/./src/forum/index.tsx","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['common/components/Button']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['common/extend']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['forum/app']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['forum/components/UserCard']\"","webpack://@xypp/flarum-custom-user-remarks/external root \"flarum.core.compat['forum/utils/UserControls']\"","webpack://@xypp/flarum-custom-user-remarks/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@xypp/flarum-custom-user-remarks/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@xypp/flarum-custom-user-remarks/webpack/bootstrap","webpack://@xypp/flarum-custom-user-remarks/webpack/runtime/compat get default export","webpack://@xypp/flarum-custom-user-remarks/webpack/runtime/define property getters","webpack://@xypp/flarum-custom-user-remarks/webpack/runtime/hasOwnProperty shorthand","webpack://@xypp/flarum-custom-user-remarks/webpack/runtime/make namespace object"],"sourcesContent":["import app from 'flarum/forum/app';\r\nimport Modal, { IInternalModalAttrs } from 'flarum/common/components/Modal';\r\nimport User from 'flarum/common/models/User';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport Button from 'flarum/common/components/Button';\r\n\r\nexport default class EditRemarkModal extends Modal<{\r\n    user: User\r\n} & IInternalModalAttrs> {\r\n    private remark: Stream<string>\r\n    oninit(vnode: any) {\r\n        super.oninit(vnode);\r\n\r\n        this.remark = Stream(this.attrs.user.data.attributes!['remark'] || \"\");\r\n    }\r\n    className(): string { return 'Modal Modal--small'; }\r\n    title() {\r\n        if (this.attrs.user.attribute('remark')) {\r\n            return app.translator.trans('xypp-custom-user-remarks.forum.edit_remark');\r\n        }\r\n        return app.translator.trans('xypp-custom-user-remarks.forum.set_remark');\r\n    }\r\n    content() {\r\n        return <div className=\"Modal-body\">\r\n            <div className=\"Form-group\">\r\n                <div className=\"Form-group\">\r\n                    <input className=\"FormControl\" bidi={this.remark} />\r\n                </div>\r\n                <div className=\"Form-group\">\r\n                    <Button className='Button Button--primary' type='submit' loading={this.loading}>\r\n                        {app.translator.trans('xypp-custom-user-remarks.forum.submit_button')}\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    onsubmit(e: SubmitEvent) {\r\n        e.preventDefault();\r\n\r\n        this.loading = true;\r\n\r\n        this.attrs.user\r\n            .save({ remark: this.remark() || null }, { errorHandler: this.onerror.bind(this) })\r\n            .then(() => {\r\n                if (this.remark()) {\r\n                    this.attrs.user.pushAttributes({\r\n                        realDisplayName: this.attrs.user.attribute(\"realDisplayName\") || this.attrs.user.displayName(),\r\n                        displayName: this.remark()\r\n                    })\r\n                } else {\r\n                    this.attrs.user.pushAttributes({\r\n                        realDisplayName: null,\r\n                        displayName: this.attrs.user.attribute(\"realDisplayName\") || this.attrs.user.displayName()\r\n                    })\r\n                }\r\n                this.hide();\r\n            })\r\n            .catch(() => {\r\n                this.loading = false;\r\n                m.redraw();\r\n            });\r\n    }\r\n}","import app from 'flarum/forum/app';\nimport { extend } from 'flarum/common/extend';\nimport UserCard from 'flarum/forum/components/UserCard';\nimport User from 'flarum/common/models/User';\nimport UserControls from 'flarum/forum/utils/UserControls';\nimport EditRemarkModal from './EditRemarkModal';\nimport Button from 'flarum/common/components/Button';\napp.initializers.add('xypp/flarum-custom-user-remarks', () => {\n  extend(UserCard.prototype, 'infoItems', function (this: UserCard, items) {\n    const user: User = (this.attrs as any).user;\n    if (user.attribute('realDisplayName')) {\n      items.add('remark-real-displayname',\n        app.translator.trans('xypp-custom-user-remarks.forum.real_display_name', { n: user.attribute('realDisplayName') })\n      );\n    }\n  });\n\n  extend(UserControls, 'moderationControls', function (items, user) {\n    if (app.forum.attribute(\"can_set_remark\")) {\n      items.add('set_remark',\n        <Button icon=\"fas fa-user-tag\" onclick={() => {\n          app.modal.show(EditRemarkModal, { user }, true);\n        }}>\n          {app.translator.trans('xypp-custom-user-remarks.forum.' + (user.attribute('remark') ? 'edit_remark' : 'set_remark'))}\n        </Button>);\n    }\n  });\n});\n","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Modal'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/utils/Stream'];","module.exports = flarum.core.compat['forum/app'];","module.exports = flarum.core.compat['forum/components/UserCard'];","module.exports = flarum.core.compat['forum/utils/UserControls'];","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};"],"names":["app","Modal","Stream","Button","EditRemarkModal","_Modal","_this","_len","arguments","length","args","Array","_key","call","apply","concat","remark","_inheritsLoose","_proto","prototype","oninit","vnode","attrs","user","data","attributes","className","title","attribute","translator","trans","content","m","bidi","type","loading","onsubmit","e","_this2","preventDefault","save","errorHandler","onerror","bind","then","pushAttributes","realDisplayName","displayName","hide","redraw","default","extend","UserCard","UserControls","initializers","add","items","n","forum","icon","onclick","modal","show","setPrototypeOf","t","o","Object","create","constructor","_setPrototypeOf","__proto__"],"sourceRoot":""}