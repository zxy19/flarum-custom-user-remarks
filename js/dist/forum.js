(()=>{var r={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return r.d(a,{a}),a},d:(t,a)=>{for(var e in a)r.o(a,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:a[e]})},o:(r,t)=>Object.prototype.hasOwnProperty.call(r,t)};(()=>{"use strict";const t=flarum.core.compat["forum/app"];var a=r.n(t);const e=flarum.core.compat["common/extend"],o=flarum.core.compat["forum/components/UserCard"];var s=r.n(o);const n=flarum.core.compat["forum/utils/UserControls"];var u=r.n(n);function i(r,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,t){return r.__proto__=t,r},i(r,t)}const l=flarum.core.compat["common/components/Modal"];var c=r.n(l);const p=flarum.core.compat["common/utils/Stream"];var d=r.n(p);const f=flarum.core.compat["common/components/Button"];var y=r.n(f),b=function(r){function t(){for(var t,a=arguments.length,e=new Array(a),o=0;o<a;o++)e[o]=arguments[o];return(t=r.call.apply(r,[this].concat(e))||this).remark=void 0,t}var e,o;o=r,(e=t).prototype=Object.create(o.prototype),e.prototype.constructor=e,i(e,o);var s=t.prototype;return s.oninit=function(t){r.prototype.oninit.call(this,t),this.remark=d()(this.attrs.user.data.attributes.remark||"")},s.className=function(){return"Modal Modal--small"},s.title=function(){return this.attrs.user.attribute("remark")?a().translator.trans("xypp-custom-user-remarks.forum.edit_remark"):a().translator.trans("xypp-custom-user-remarks.forum.set_remark")},s.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form-group"},m("div",{className:"Form-group"},m("input",{className:"FormControl",bidi:this.remark})),m("div",{className:"Form-group"},m(y(),{className:"Button Button--primary",type:"submit",loading:this.loading},a().translator.trans("xypp-custom-user-remarks.forum.submit_button")))))},s.onsubmit=function(r){var t=this;r.preventDefault(),this.loading=!0,this.attrs.user.save({remark:this.remark()||null},{errorHandler:this.onerror.bind(this)}).then((function(){t.remark()?t.attrs.user.pushAttributes({realDisplayName:t.attrs.user.attribute("realDisplayName")||t.attrs.user.displayName(),displayName:t.remark()}):t.attrs.user.pushAttributes({realDisplayName:null,displayName:t.attrs.user.attribute("realDisplayName")||t.attrs.user.displayName()}),t.hide()})).catch((function(){t.loading=!1,m.redraw()}))},t}(c());a().initializers.add("xypp/flarum-custom-user-remarks",(function(){(0,e.extend)(s().prototype,"infoItems",(function(r){var t=this.attrs.user;t.attribute("realDisplayName")&&r.add("remark-real-displayname",a().translator.trans("xypp-custom-user-remarks.forum.real_display_name",{n:t.attribute("realDisplayName")}))})),(0,e.extend)(u(),"moderationControls",(function(r,t){a().forum.attribute("can_set_remark")&&r.add("set_remark",m(y(),{icon:"fas fa-user-tag",onclick:function(){a().modal.show(b,{user:t},!0)}},a().translator.trans("xypp-custom-user-remarks.forum."+(t.attribute("remark")?"edit_remark":"set_remark"))))}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map